<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.5.2">Jekyll</generator><link href="http://yamakarov.ru/feed.xml" rel="self" type="application/atom+xml" /><link href="http://yamakarov.ru/" rel="alternate" type="text/html" /><updated>2018-08-22T15:28:05+03:00</updated><id>http://yamakarov.ru/</id><title type="html">Записки Java программиста</title><subtitle>Блог о разработке web админок, CRM-ок и прочего. 
</subtitle><entry><title type="html">Когда код меняет тебя</title><link href="http://yamakarov.ru/code/2018/08/22/refactoring.html" rel="alternate" type="text/html" title="Когда код меняет тебя" /><published>2018-08-22T15:20:00+03:00</published><updated>2018-08-22T15:20:00+03:00</updated><id>http://yamakarov.ru/code/2018/08/22/refactoring</id><content type="html" xml:base="http://yamakarov.ru/code/2018/08/22/refactoring.html">&lt;p&gt;Заметил такую слабость за собой:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Во время ревью кода я понимаю, что код написан не идеально у этой задачи есть другое лучшее решение&lt;/li&gt;
  &lt;li&gt;Сажусь разбираться с чужим решением, чтобы понять где нужно подправить чтобы получилось мое решение&lt;/li&gt;
  &lt;li&gt;По ходу разбирательства понимаю, что можно подправить и пофиксить баг не воплощая свое лучшее решение&lt;/li&gt;
  &lt;li&gt;Исправляю чужое решение, баг фиксится, но технический долг растет&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;После такой итерации свое решение внедрить становится сложнее, и этот ком растет и растет, пока не начинает влиять на скорость добаления новой функциональности.
Этого никто не замечает, потому что существующее решение не только накладывает ограничения на то, что можно сделать, но она также не дает и помыслить о том что можно сделать.&lt;/p&gt;

&lt;p&gt;Стоит ли всегда внедрять прорывные, порой рискованные решения. Наверное, нет. Стоит ли всегда фиксить плохое решение, ну тоже наверное нет.
Люди выступающие за фиксы, оправдывают это бизнес составляющей, но при этом если бизнес от этого не выигрывает в постоянной конкурентной гонке, что становится очевидно не сразу, то это оправдание не работает.&lt;/p&gt;</content><author><name></name></author><summary type="html">Заметил такую слабость за собой: Во время ревью кода я понимаю, что код написан не идеально у этой задачи есть другое лучшее решение Сажусь разбираться с чужим решением, чтобы понять где нужно подправить чтобы получилось мое решение По ходу разбирательства понимаю, что можно подправить и пофиксить баг не воплощая свое лучшее решение Исправляю чужое решение, баг фиксится, но технический долг растет</summary></entry><entry><title type="html">Даты в Java</title><link href="http://yamakarov.ru/java/2018/08/21/date.html" rel="alternate" type="text/html" title="Даты в Java" /><published>2018-08-21T18:50:00+03:00</published><updated>2018-08-21T18:50:00+03:00</updated><id>http://yamakarov.ru/java/2018/08/21/date</id><content type="html" xml:base="http://yamakarov.ru/java/2018/08/21/date.html">&lt;p&gt;Оказывается два &lt;code class=&quot;highlighter-rouge&quot;&gt;java.util.Date&lt;/code&gt; могут быть:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;before&lt;/li&gt;
  &lt;li&gt;after&lt;/li&gt;
  &lt;li&gt;equals&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Если подумать то логично, но я сегодня наступил на грабли.&lt;/p&gt;</content><author><name></name></author><summary type="html">Оказывается два java.util.Date могут быть: before after equals</summary></entry><entry><title type="html">Послойная архитектура</title><link href="http://yamakarov.ru/architecture/2018/08/20/layer-architecture.html" rel="alternate" type="text/html" title="Послойная архитектура" /><published>2018-08-20T16:22:00+03:00</published><updated>2018-08-20T16:22:00+03:00</updated><id>http://yamakarov.ru/architecture/2018/08/20/layer-architecture</id><content type="html" xml:base="http://yamakarov.ru/architecture/2018/08/20/layer-architecture.html">&lt;p&gt;Современные web-приложения пишутся в архитектуре клиент-сервер.
В моем случае, в качестве клиента выступает браузер, а в качестве сервера Java приложение работающее на Tomcat с использованием Spring.
Клиентская часть довольно запутана, но можно сказать что она представляет Angular приложение в архитектуре MVC.
Серверная часть проще, это послойная архитектура.
Я обычно выделяю такие слои:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Контроллеры - принимают http запросы, парсят параметры и преобразуют результат в текстовое представление, json или html&lt;/li&gt;
  &lt;li&gt;Сервисы - контроллеры не должны выполнять никакой логики, так как их не очень удобно тестировать, хотя Spring представляет средства и для этого;
сервисы выполняют всю работу и содержат бизнес логику программы&lt;/li&gt;
  &lt;li&gt;Репозитории - в репозиториях строится отображение объектов на таблицы базы данных, объекты разбираются для сохранения и собираются для обработки в сервисах&lt;/li&gt;
  &lt;li&gt;DAO - непосредственно работают с базой данных, в них инкапсулирована логика хранения данных в таблицах, работа с соединениями и другой рутиной доступа к данным&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;В целом послойная архитектура упрощает работу.&lt;/p&gt;</content><author><name></name></author><summary type="html">Современные web-приложения пишутся в архитектуре клиент-сервер. В моем случае, в качестве клиента выступает браузер, а в качестве сервера Java приложение работающее на Tomcat с использованием Spring. Клиентская часть довольно запутана, но можно сказать что она представляет Angular приложение в архитектуре MVC. Серверная часть проще, это послойная архитектура. Я обычно выделяю такие слои: Контроллеры - принимают http запросы, парсят параметры и преобразуют результат в текстовое представление, json или html Сервисы - контроллеры не должны выполнять никакой логики, так как их не очень удобно тестировать, хотя Spring представляет средства и для этого; сервисы выполняют всю работу и содержат бизнес логику программы Репозитории - в репозиториях строится отображение объектов на таблицы базы данных, объекты разбираются для сохранения и собираются для обработки в сервисах DAO - непосредственно работают с базой данных, в них инкапсулирована логика хранения данных в таблицах, работа с соединениями и другой рутиной доступа к данным</summary></entry><entry><title type="html">Пример использования PhantomReference</title><link href="http://yamakarov.ru/java/phantom/2018/08/17/phantom.html" rel="alternate" type="text/html" title="Пример использования PhantomReference" /><published>2018-08-17T12:41:00+03:00</published><updated>2018-08-17T12:41:00+03:00</updated><id>http://yamakarov.ru/java/phantom/2018/08/17/phantom</id><content type="html" xml:base="http://yamakarov.ru/java/phantom/2018/08/17/phantom.html">&lt;p&gt;В ленте Twitter прочитал &lt;a href=&quot;https://twitter.com/dbg_nsk/status/1030313002208292864&quot;&gt;задачку&lt;/a&gt; про &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/api/java/lang/ref/PhantomReference.html&quot;&gt;PhantomReference&lt;/a&gt;
Я решил посмотреть, как используются фантомные ссылки в Одноклассниках.
В приведенном коде я использую идею из кодовой базы проекта, но с добавлением собственных комментариев и багов, в силу скудоумия:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ru&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;yamakarov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;examples&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.lang.ref.PhantomReference&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.lang.ref.ReferenceQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;java.util.concurrent.ConcurrentHashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Phantom&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;gc&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Ресурс, который мы хотим почистить, когда объект станет доступен только по фантомной ссылке&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;resource&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Объект использующий ресурс&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Garbage&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;garbage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Garbage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Cleaner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;garbage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

            &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
            &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;clean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s&quot;&gt;&quot;Cleaned &quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;};&lt;/span&gt;

    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;// Класс освобождающий ресурсы после того, как использующий их объект стал недоступен&lt;/span&gt;
&lt;span class=&quot;kd&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Cleaner&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;extends&lt;/span&gt;  &lt;span class=&quot;n&quot;&gt;PhantomReference&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;c1&quot;&gt;// Очередь в которую попадают объекты требующие очистки&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ReferenceQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queue&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ReferenceQueue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;// Храним ссылки, чтобы они не были собраны сборкой мусора&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ConcurrentHashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cleaner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Cleaner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;allCleaners&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ConcurrentHashMap&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;&amp;lt;&amp;gt;();&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;thread&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;-&amp;gt;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;k&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                &lt;span class=&quot;k&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;Cleaner&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ref&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Cleaner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;allCleaners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;remove&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;ref&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;clean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;InterruptedException&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;e&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
                    &lt;span class=&quot;n&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;currentThread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;interrupt&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
                &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
            &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;});&lt;/span&gt;
        &lt;span class=&quot;c1&quot;&gt;// Делаем поток демоном, так как он должен остановиться когда закончилось приложение&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;setDaemon&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;thread&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;start&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;


    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Cleaner&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Object&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;kd&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;referent&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;queue&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;allCleaners&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;put&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;clean&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;();&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;


&lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Garbage&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Garbage&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;nd&quot;&gt;@Override&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;toString&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;()&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;Garbage{&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;resource='&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;resource&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;sc&quot;&gt;'\''&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;sc&quot;&gt;'}'&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;</content><author><name></name></author><summary type="html">В ленте Twitter прочитал задачку про PhantomReference Я решил посмотреть, как используются фантомные ссылки в Одноклассниках. В приведенном коде я использую идею из кодовой базы проекта, но с добавлением собственных комментариев и багов, в силу скудоумия:</summary></entry><entry><title type="html">Объектно ориентированное программирование</title><link href="http://yamakarov.ru/oop/2018/08/16/oop.html" rel="alternate" type="text/html" title="Объектно ориентированное программирование" /><published>2018-08-16T19:04:00+03:00</published><updated>2018-08-16T19:04:00+03:00</updated><id>http://yamakarov.ru/oop/2018/08/16/oop</id><content type="html" xml:base="http://yamakarov.ru/oop/2018/08/16/oop.html">&lt;p&gt;Парадигма объектно-ориентированного программирования появилась довольно давно и впервые была реализована в языке Simula.
В принципе, для того чтобы писать в объектно ориентированном стиле совершенно не обязательно иметь поддержку со стороны языка.
Верно и обратное, никакая поддержка в языке не заставит вас писать в объектно ориентированной парадигме.
Для этого недостаточно разбить программу на классы, в рантайме создавать объекты и вызывать у них метода, представляя что вы передаете сообщения.
Смысл объектно ориентированного программирования я вижу в другом.
Программа создается как граф, вершинами которого являются объекты, а ребрами связи позволяющие передавать информацию от одного объекта к другому.
У такой программы есть вход и выход, она получает данные от пользователя, производит вычисления отправляя результаты от вершины к вершине по ребрам графа и на выводит результат.
Для того, чтобы программа была гибкой, то есть могла обрабатывать большое разнообразие входных данных при этом имея ограниченный набор классов.
Понятно, что не ограничивая набор классов мы получим для каждого набора данных свой класс выполняющий вычисления. 
Так как часто наборы данных связаны между собой, изменяя правила обработки связанных наборов нам надо будет менять множество классов.
И это не очень хорошо и поэтому желательно, чтобы мы могли комбинировать классы для получения результата.
Таким образом желательно, чтобы объекты как слова в предложении могли идти в разном порядке предавая разный смысл высказыванию.
И где здесь находятся предметно ориентированные языки и желательно чтобы классы были словарем этого языка, а графы объектов - программы были бы предложениями на этом языке.
И использую это предложение можно было бы получать смысл, некий результат вычислений.&lt;/p&gt;

&lt;p&gt;Такое на практике я видел очень редко.
Чаще встречается другое использование ооп.
Классы заменяют наборы switch утверждений по типу объекта, объединяя в одном классе несколько функций можно избавиться от всех переключателей по коду и легко можно добавить еще один случай в во все переключатели.
Бывает что программа создается как большой агрегат, в который можно добавлять детали. 
И тут объекты выступают как неплохие модули для упрощения навигации по коду, но программа от этого не становится объектно ориентированной и вы с таким же успехом можете сделать все методы статичными, особенно когда все ваши объекты синглтоны.&lt;/p&gt;</content><author><name></name></author><summary type="html">Парадигма объектно-ориентированного программирования появилась довольно давно и впервые была реализована в языке Simula. В принципе, для того чтобы писать в объектно ориентированном стиле совершенно не обязательно иметь поддержку со стороны языка. Верно и обратное, никакая поддержка в языке не заставит вас писать в объектно ориентированной парадигме. Для этого недостаточно разбить программу на классы, в рантайме создавать объекты и вызывать у них метода, представляя что вы передаете сообщения. Смысл объектно ориентированного программирования я вижу в другом. Программа создается как граф, вершинами которого являются объекты, а ребрами связи позволяющие передавать информацию от одного объекта к другому. У такой программы есть вход и выход, она получает данные от пользователя, производит вычисления отправляя результаты от вершины к вершине по ребрам графа и на выводит результат. Для того, чтобы программа была гибкой, то есть могла обрабатывать большое разнообразие входных данных при этом имея ограниченный набор классов. Понятно, что не ограничивая набор классов мы получим для каждого набора данных свой класс выполняющий вычисления. Так как часто наборы данных связаны между собой, изменяя правила обработки связанных наборов нам надо будет менять множество классов. И это не очень хорошо и поэтому желательно, чтобы мы могли комбинировать классы для получения результата. Таким образом желательно, чтобы объекты как слова в предложении могли идти в разном порядке предавая разный смысл высказыванию. И где здесь находятся предметно ориентированные языки и желательно чтобы классы были словарем этого языка, а графы объектов - программы были бы предложениями на этом языке. И использую это предложение можно было бы получать смысл, некий результат вычислений.</summary></entry><entry><title type="html">Мой неполный и неупорядоченный список заповедей программирования</title><link href="http://yamakarov.ru/software/2018/08/15/software-precepts.html" rel="alternate" type="text/html" title="Мой неполный и неупорядоченный список заповедей программирования" /><published>2018-08-15T17:21:00+03:00</published><updated>2018-08-15T17:21:00+03:00</updated><id>http://yamakarov.ru/software/2018/08/15/software-precepts</id><content type="html" xml:base="http://yamakarov.ru/software/2018/08/15/software-precepts.html">&lt;p&gt;Я стараюсь придерживаться следующих правил:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Не используй объектно-ориентированное программирование всуе&lt;/li&gt;
  &lt;li&gt;Не делай функции с числом аргументов более трех и вызываемые из одного места программы&lt;/li&gt;
  &lt;li&gt;Не выкладывай не протестировав&lt;/li&gt;
  &lt;li&gt;Не делай пользовательскую работу&lt;/li&gt;
  &lt;li&gt;Не пиши код по ночам&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Продолжение следует…&lt;/p&gt;</content><author><name></name></author><summary type="html">Я стараюсь придерживаться следующих правил:</summary></entry><entry><title type="html">C не низкоуровневый язык</title><link href="http://yamakarov.ru/c/2018/08/14/low-level-c.html" rel="alternate" type="text/html" title="C не низкоуровневый язык" /><published>2018-08-14T17:05:00+03:00</published><updated>2018-08-14T17:05:00+03:00</updated><id>http://yamakarov.ru/c/2018/08/14/low-level-c</id><content type="html" xml:base="http://yamakarov.ru/c/2018/08/14/low-level-c.html">&lt;p&gt;Наткнулся на интересную статью &lt;a href=&quot;https://queue.acm.org/detail.cfm?id=3212479&quot;&gt;C Is Not a Low-level Language&lt;/a&gt;.
Автор Давид Чиснол(David Chisnall) утверждает, что язык C больше не является низкоуровневым языком.
Давно прошли те времена, когда инструкции C простым способом отображались на низкоуровневые команды PDP-11.
Сейчас большие и сложные компиляторы хитрым образом преобразуют код на C в машинные инструкции.
Все это нужно, чтобы:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Параллельно выполнять последовательный код&lt;/li&gt;
  &lt;li&gt;Эффективно использовать кэши процессора&lt;/li&gt;
  &lt;li&gt;Увеличивать скорость за счет векторизации вычислений&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Автор утверждает, что абстрактная машина, которая лежит в основе языка C устарела.
Можно создавать более быстрый код и более быстрые процессоры, если не пытаться писать его на C и не заставлять процессоры имитировать PDP-11.&lt;/p&gt;

&lt;p&gt;И хотя я не могу себе представить, как улучшить модель, я смутно догадываюсь, что использование языков более приспособленных к современному железу может дать огромное преимущество.&lt;/p&gt;

&lt;p&gt;Упомянутые автором аппаратные реализации сборщика мусора, увеличение количества одновременно выполняемых потоков и обмен неизменяемыми данными, кажутся перспективными.&lt;/p&gt;</content><author><name></name></author><summary type="html">Наткнулся на интересную статью C Is Not a Low-level Language. Автор Давид Чиснол(David Chisnall) утверждает, что язык C больше не является низкоуровневым языком. Давно прошли те времена, когда инструкции C простым способом отображались на низкоуровневые команды PDP-11. Сейчас большие и сложные компиляторы хитрым образом преобразуют код на C в машинные инструкции. Все это нужно, чтобы: Параллельно выполнять последовательный код Эффективно использовать кэши процессора Увеличивать скорость за счет векторизации вычислений</summary></entry><entry><title type="html">one-nio: компилируем Java на лету</title><link href="http://yamakarov.ru/java/one-nio/2018/08/13/compile-java.html" rel="alternate" type="text/html" title="one-nio: компилируем Java на лету" /><published>2018-08-13T14:06:00+03:00</published><updated>2018-08-13T14:06:00+03:00</updated><id>http://yamakarov.ru/java/one-nio/2018/08/13/compile-java</id><content type="html" xml:base="http://yamakarov.ru/java/one-nio/2018/08/13/compile-java.html">&lt;p&gt;В библиотеке &lt;a href=&quot;https://github.com/odnoklassniki/one-nio&quot;&gt;one-nio&lt;/a&gt; есть возможность компилировать Java код на лету.
Это может быть нужно, когда вы хотите дать пользователю возможность задавать формулы для вычисления значений.
Как-то мне нужно было посчитать вес тасков для отдачи пользователям по сложной формуле, которая зависела от квалификации пользователя и типа таска.
Я решил эту задачу используя встроенный в jvm движок &lt;a href=&quot;https://docs.oracle.com/javase/10/nashorn/toc.htm&quot;&gt;Nashorn&lt;/a&gt;.
Писал куски кода на Javascript, компилировал и запускал в программе.&lt;/p&gt;

&lt;p&gt;Можно обойтись без Javascript, если писать и компилировать прямо Java код:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ru&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;yamakarov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;gen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;one.nio.compiler.CompilationException&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;one.nio.compiler.Javac&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;kn&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;nn&quot;&gt;one.nio.gen.BytecodeGenerator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;FunctionScript&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;main&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;args&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;throws&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;CompilationException&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;template&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;package ru.yamakarov.gen;\n&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;\n&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;public class GeneratedScales extends Scales {\n&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;    public int weight (Context context) {\n&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;        return %s;\n&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;    }\n&quot;&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;+&lt;/span&gt;
                &lt;span class=&quot;s&quot;&gt;&quot;}&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;functionStr&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;&quot;context.multiplier * 10&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;kt&quot;&gt;byte&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;[]&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;classData&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Javac&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;compile&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;
                &lt;span class=&quot;n&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;format&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;template&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;functionStr&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;
        &lt;span class=&quot;n&quot;&gt;Scales&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;myScales&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;BytecodeGenerator&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;().&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;instantiate&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;classData&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Scales&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;class&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;);&lt;/span&gt;

        &lt;span class=&quot;n&quot;&gt;System&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;out&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;println&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;myScales&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;weight&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)));&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Можно писать в файле или в базе данных код функции:&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;String functionStr = &quot;context.multiplier * 10&quot;;
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Подставлять его в шаблон, расширяющий класс &lt;code class=&quot;highlighter-rouge&quot;&gt;Scales&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ru&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;yamakarov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;gen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Scales&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;weight&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;Context&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Итоговый экземпляр &lt;code class=&quot;highlighter-rouge&quot;&gt;myScales&lt;/code&gt; можно сохранять для повторного использования, чтобы сократить время вызова.
Также в &lt;code class=&quot;highlighter-rouge&quot;&gt;context&lt;/code&gt; можно передавать и другие параметры, кроме использованного мною &lt;code class=&quot;highlighter-rouge&quot;&gt;multiplier&lt;/code&gt;:&lt;/p&gt;

&lt;figure class=&quot;highlight&quot;&gt;&lt;pre&gt;&lt;code class=&quot;language-java&quot; data-lang=&quot;java&quot;&gt;&lt;span class=&quot;kn&quot;&gt;package&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;ru&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;yamakarov&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;gen&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kd&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Context&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;multiplier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;kd&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;Context&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;kt&quot;&gt;int&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;multiplier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;k&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;na&quot;&gt;multiplier&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;multiplier&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/figure&gt;

&lt;p&gt;Я не проверял, но такой способ должен работать быстрее использования javascript движка, будет поддерживать jit оптимизации, в случае частого вызова метода, который был получен от пользователя и больше мне нравится.&lt;/p&gt;</content><author><name></name></author><summary type="html">В библиотеке one-nio есть возможность компилировать Java код на лету. Это может быть нужно, когда вы хотите дать пользователю возможность задавать формулы для вычисления значений. Как-то мне нужно было посчитать вес тасков для отдачи пользователям по сложной формуле, которая зависела от квалификации пользователя и типа таска. Я решил эту задачу используя встроенный в jvm движок Nashorn. Писал куски кода на Javascript, компилировал и запускал в программе.</summary></entry><entry><title type="html">Доказательство корретности программ</title><link href="http://yamakarov.ru/cs/2018/08/10/program-proofs.html" rel="alternate" type="text/html" title="Доказательство корретности программ" /><published>2018-08-10T17:18:00+03:00</published><updated>2018-08-10T17:18:00+03:00</updated><id>http://yamakarov.ru/cs/2018/08/10/program-proofs</id><content type="html" xml:base="http://yamakarov.ru/cs/2018/08/10/program-proofs.html">&lt;p&gt;Я знаю несколько способов убедиться в корректности программы:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Провести тестирование&lt;/li&gt;
  &lt;li&gt;Провести мысленный эксперимент с целью понять как программа работает&lt;/li&gt;
  &lt;li&gt;Строго доказать корректность программы, на основе теорем выведенных из аксиом&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;На практике я применяю первый два способа.
Хочется ввести в свой арсенал и третий способ, но этот зверь очень сложен и требует определенного склада ума.&lt;/p&gt;

&lt;p&gt;Почему мне хочется строго доказывать корректность программы?
Это есть простое объяснение. 
Тестирование и мысленные эксперименты не работают.
Мысленный эксперимент в моем случае не работает совсем и подводит в 90% случаев.
На практике получается, что пока не запустишь программу сказать будет ли она работать или нет нельзя.&lt;/p&gt;

&lt;p&gt;Тестирование тоже не работает довольно часто. 
Оно удобно для сокращения времени запуска программы, и тем самым ускоряет разработку, но не решает проблем с ошибками в программе.
Ошибки все равно остаются, и в большом количестве, причем может создаться впечатление, что вы достаточно хорошо покрыли программу тестами, но это смею вас заверить не так, ну или я просто не умею писать тесты.
Из своего опыта я не заметил корреляции между способностями программиста и тем пишет ли он качественный код. 
Плохие программисты пишут и не пишут тесты. Также и хорошие программисты пишут и не пишут тесты.
Я для себя решил писать некоторое количество тестов, особенно если это какие-то сложные вычисления.
Еще одна проблема с тестами, то что как и код и надо поддерживать.&lt;/p&gt;

&lt;p&gt;Так как два способа написания программ без ошибок в моем случае не работают, я хочу попробовать третий. 
В надежде, что он станет серебряной пулей. 
Что, конечно, не так, не станет.
Самый базовый способ доказательства корректности это использование статически типизированных языков.
Я использую Java и Typescript, еще Dart, но с ним как-то у меня плохие отношения, не нравится совсем.
Типизация спасает от дурацких ошибок и помогает при рефакторинге, но работает при правильном проектировании программы.
Если вы повсюду используете ассоциативные массивы, в виде HashMap или чего-то подобного, никакая типизация вас не спасет.
Опять же в Java типизация не спасает от самой распространенной ошибки NullPointerException.&lt;/p&gt;

&lt;p&gt;Можно не ограничиваться доказательством соответствия типов переменных, а пойти дальше и следуя Флойду, Лампорту и Хоару доказывать корректность программ строго математически.
И на самом деле, это обязательно делать в случае многопоточных программ. 
В программах, выполняемых в нескольких потоках вообще очень плохой работает мысленный эксперимент и еще хуже работают тесты.
Проблема с доказательством в том, что формальные доказательства очень длинные и не владея методом практически невозможно прийти к методике. 
Надо знать требования к строгости доказательства и уметь строить доказательства, а этому в большинстве вузов не учат. 
Во всяком случае, средний студент по моему опыту этим не владеет. 
В строго доказанной программе могут быть ошибки, но они довольно быстро находятся. 
Я верю Дейкстре, который смог полностью доказать даже такую большую программу, как операционная система.
Дейкстра утверждал, что в его ос, ошибки были либо простыми опечатками, либо очень быстро фиксились из-за того, что явно противоречили ходу доказательства.&lt;/p&gt;</content><author><name></name></author><summary type="html">Я знаю несколько способов убедиться в корректности программы: Провести тестирование Провести мысленный эксперимент с целью понять как программа работает Строго доказать корректность программы, на основе теорем выведенных из аксиом</summary></entry><entry><title type="html">Онлайн конструктор графиков</title><link href="http://yamakarov.ru/idea/2018/08/09/graph-creator.html" rel="alternate" type="text/html" title="Онлайн конструктор графиков" /><published>2018-08-09T17:49:00+03:00</published><updated>2018-08-09T17:49:00+03:00</updated><id>http://yamakarov.ru/idea/2018/08/09/graph-creator</id><content type="html" xml:base="http://yamakarov.ru/idea/2018/08/09/graph-creator.html">&lt;p&gt;Сегодня по дороге на работу в голову пришла мысль, которой я захотел поделиться.
С помощью библиотеки &lt;a href=&quot;https://www.highcharts.com/&quot;&gt;Highcharts&lt;/a&gt; можно строить &lt;a href=&quot;https://www.highcharts.com/demo&quot;&gt;красивые графики&lt;/a&gt;.
Кроме этого эта библиотека умеет сохранять графики в файл, которые потом можно вставлять на свою страницу.
Я хотел сделать свой конструктор, но вовремя нашел, что есть &lt;a href=&quot;https://cloud.highcharts.com/&quot;&gt;Highcharts Cloud&lt;/a&gt; и туда можно заливать свои данные и строить графики.&lt;/p&gt;

&lt;p&gt;К примеру, скачаем данные о &lt;a href=&quot;http://www.gks.ru/wps/wcm/connect/rosstat_main/rosstat/ru/statistics/ftrade/#&quot;&gt;внешней торговле РФ&lt;/a&gt; с сайта Росстата и вот какой график у нас получится:&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;http://yamakarov.ru/img/rf_trade_balance.png&quot; alt=&quot;Внешняя торговля РФ&quot; /&gt;&lt;/p&gt;</content><author><name></name></author><summary type="html">Сегодня по дороге на работу в голову пришла мысль, которой я захотел поделиться. С помощью библиотеки Highcharts можно строить красивые графики. Кроме этого эта библиотека умеет сохранять графики в файл, которые потом можно вставлять на свою страницу. Я хотел сделать свой конструктор, но вовремя нашел, что есть Highcharts Cloud и туда можно заливать свои данные и строить графики.</summary></entry></feed>